
# 원형 다각형 기반 ETF 시장 구조 시각화 프로젝트 명세서 (최종판)

## 1. 프로젝트 개요

* **목적**
  다수의 ETF 시계열 데이터를 통합하여, 시장 전체의 계층적 자금 흐름과 구조 변화를 원형 다각형(Sunburst) 형태로 시각화함.
  투자자, 리서처, 운용자가 시간에 따른 섹터별 자금 이동 및 시장 변화를 직관적으로 탐색할 수 있도록 지원.

* **핵심 가치**

  * 시장 구조의 다층적 시각화
  * 시계열 기반 동적 변화 관찰
  * 계층별 거래량 및 가격 변동에 따른 인사이트 제공

---

## 2. 데이터 구성

### 2.1 데이터 위치 및 파일명

* 폴더 경로: `./nasdaq_etf_data`
* 파일명 형식: `{ETF명}_{주기}.csv`
  예: `XLF_1d.csv`, `XLK_1d.csv`

### 2.2 CSV 내부 구조

| 행 번호 | 내용                                 | 설명                            |
| ---- | ---------------------------------- | ----------------------------- |
| 1행   | `Price,Close,High,Low,Open,Volume` | 데이터 항목 헤더                     |
| 2행   | `Ticker,XLF,XLF,XLF,XLF,XLF`       | 각 컬럼별 종목 코드                   |
| 3행   | `Date,,,,,`                        | 날짜 컬럼 명시, 이후 4행부터 데이터 시작      |
| 4행\~ | 날짜별 가격 및 거래량 시계열 데이터               | `Close`(종가), `Volume`(거래량) 포함 |

* 날짜 형식: `YYYY-MM-DD`
* ETF별 데이터 시작일 및 길이 상이 가능
* ETF명은 파일명에서 추출하여 최상위 노드 구분에 사용

### 2.3 데이터 특성과 계층 정보 한계

* CSV 데이터에는 ETF 자체 가격·거래량 정보만 포함
* **ETF 내 개별 구성 종목 정보는 포함되어 있지 않음**
* 따라서 기본 계층 구조는 ETF명 단위의 단층 구조임
* 산업군·산업 단위 계층 추가를 위해서는 별도의 외부 매핑 테이블 (예: 티커 → GICS Sector 등)이 필요함

---

## 3. 시각화 구조 및 주요 기능

### 3.1 계층 구조 설계

* 최상위 노드: **ETF명** (섹터 단위로 간주 가능)

  * ETF는 섹터 기반 ETF 뿐 아니라 테마형, 혼합형 등 다양한 유형 포함 가능
  * 섹터 단위 분류를 원할 경우 추가 분류 로직 또는 외부 분류 체계 적용 필요

* 하위 노드: **기본적으로 ETF 자체 단일 노드**

  * 구성 종목 단위 계층화는 현재 데이터 범위 밖이며, 추후 구성 종목 데이터 확보 시 확장 가능

* 구조는 고정된 계층 구조이며, 시계열 변화에 따라 노드별 값(크기, 색상)만 변경

### 3.2 시각화 표현

| 요소    | 매핑 대상                 | 설명                      |
| ----- | --------------------- | ----------------------- |
| 면적 크기 | 거래량(`Volume`) 합산값     | 각 ETF별 또는 노드별 거래량 기반 크기 |
| 색상    | 종가(`Close`) 또는 가격 변동률 | 날짜별 가격 변화에 따른 색상 변화     |
| 레이블   | ETF명                  | 추후 구성 종목명 등 확장 가능       |

### 3.3 사용자 인터랙션

* 마우스오버 툴팁: 가격, 거래량, 날짜 등 상세 정보 표시
* 클릭 시 계층 확대/축소 (현재 1\~2단계 구조 기준)
* 확대/축소 및 차트 회전 가능
* 시계열 애니메이션 제어: 슬라이더, 재생/정지 버튼 포함

---

## 4. 시계열 데이터 처리 및 애니메이션 구현

### 4.1 날짜 기준 및 결측치 처리

* ETF별로 날짜 범위가 다르므로, **전체 공통 날짜 범위**를 기준으로 시계열 데이터 통합
* 누락된 날짜 데이터는 **직전 값 유지(Fill Forward)** 방식으로 보간 처리
* 보간 대상 지표: `Close`, `Volume` 등

### 4.2 애니메이션 구성

* 각 날짜별 Sunburst 프레임 생성

* 노드별 거래량에 따라 면적 업데이트, 종가에 따라 색상 업데이트

* 슬라이더와 연동하여 날짜 변경 시 차트 자동 갱신

* **참고**: 구조는 변하지 않고, 값만 변화하는 형태로 Sunburst 애니메이션 구현

---

## 5. 기술 사양 및 개발 환경

| 구분       | 내용                                       |
| -------- | ---------------------------------------- |
| 프로그래밍 언어 | Python 3.x                               |
| 데이터 처리   | pandas                                   |
| 시각화      | Plotly (`plotly.graph_objects.Sunburst`) |
| 개발 환경    | Jupyter Notebook, VSCode 등 로컬 환경         |

---

## 6. 확장 가능성 및 유의사항

### 6.1 산업군 및 산업 계층 추가

* ETF → 산업군 → 산업 등 다층 구조 확장을 위해서는
* 외부 매핑 테이블(예: 티커 → GICS Sector → Industry) 필요
* 해당 매핑 데이터 확보 및 정제 과정 별도 요구됨

### 6.2 ETF 유형 다양성 및 섹터 구분

* ETF는 섹터 기반 외에도 테마형, 혼합형, 채권형 등 다양한 유형 포함
* 섹터 단위로 통합 시 적절한 분류 로직 또는 사전 분류 작업 필요

### 6.3 시계열 동기화 및 보간

* 서로 다른 기간·누락 데이터 처리 정책 명확화 필요
* 데이터 보간, 필터링 정책 일관성 유지 권장

---

## 7. 기대 효과

* 시장 전체의 자금 흐름과 구조 변화를 직관적으로 파악 가능
* ETF별 거래량 및 가격 변동 동향의 시계열 탐색 가능
* 투자 전략 수립과 리서치에 데이터 기반 시각화 툴 제공
* 산업군 확장 시 더욱 세밀한 섹터별 분석 지원

